<!DOCTYPE html>
<html>
	<head>
		<meta charset=utf-8 />
		<title>GeoJSON custom markers and style</title>
		<meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
		<script src="lib/jquery-1.7.2.min.js"></script>
		<script src='lib/mapbox.js'></script>
		<script src="src/color/ColorPallet.js"></script>
		<script>
			var load = function(id, type, ziptype) {
				str = "#feature-".concat(id.toString());
				if (type === "MultiPolygon" || type === "Polygon") {
					$.get("/audit_stats/area_percent/".concat(ziptype,"/",id), function(data) { 
						$(str).html(data.trim().concat("% audited."));
					});
				} else {
					$.get("/audit_stats/total_audits/".concat(id), function(data) { 
						if (data.trim() == "1") {
						  var plural = "person has";
						} else {
						  var plural = "people have";
						}
						$(str).html(data.concat(" ", plural, " audited this way. <a href=\"/audit/", id, "\">Audit</a>"));
					});
				}
			};
		</script>
		<link href='css/mapbox.css' rel='stylesheet' />
		<style>
			body { margin:0; padding:0; }
			#map { position:absolute; top:0; bottom:0; width:100%; }
			.FeaturePopup { width: 500px; }
			#zipRadio { position: absolute; top: 5%; right: 5%; background: #eeeeee; border-radius: 6px; }
			#loading { position: absolute; bottom: 5%; right: 5%; font-family: sans-serif; }
		</style>
	</head>
	<body>
		<div id='map'></div>
		<div id="zipRadio">
			<form>
				<input type="radio" name="group" id="zip_zip" disabled />Zip code<br />
				<input type="radio" name="group" id="zip_neighborhood" disabled />Neighborhood
			</form>
		</div>
		<div id="loading">
			<div id="loading_zip">
				<img src="/resources/ajax-loader.gif" />
				Loading zip code map... Please wait.
			</div>
			<div id="loading_neighborhood">
				<img src="/resources/ajax-loader.gif" />
				Loading neighborhood map... Please wait.
			</div>
		</div>
		<script src="src/Progress/Core.js"></script>
		<script src="src/Progress/Streets.js"></script>
		<script>
			$(document).ready(function () {
				Progress.core.init();
				if (localStorage.getItem("zip") === "true") {
					$("#zip_zip").prop("checked", true);
					$("#zip_neighborhood").prop("checked", false);
				} else if (localStorage.getItem("zip") === "false") {
					$("#zip_zip").prop("checked", false);
					$("#zip_neighborhood").prop("checked", true);
				} else if (localStorage.getItem("zip") === null) {
					$("#zip_zip").prop("checked", true);
					localStorage.setItem("zip", true);
				} else { alert("Error? ".concat(localStorage.getItem("zip"))); }
				$("#zip_zip").prop("disabled", false);
				$("#zip_neighborhood").prop("disabled", false);
			});
		</script>
	</body>
</html>
